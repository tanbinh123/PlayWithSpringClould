
# 为什么需要分库分表

为了支撑高并发、数据量大两个问题的。

**分表**

单表数据量太大，会影响 sql 的执行性能，到后面你的 sql 就会跑得很慢了。一般来说，单表到几百万的时候，就得分表了。

**分库**
一个库的一般而言最多支撑并发 2000，一定要扩容了。

# 分库分表中间件

- cobar
- TDDL
- atlas
- sharding-jdbc
- mycat


**sharding-jdbc**

当当开源的，属于 client 层方案。确实之前用的还比较多一些，因为 SQL 语法支持也比较多，没有太多限制，而且目前推出到了 2.0 版本，支持分库分表、读写分离、分布式 id 生成、柔性事务（最大努力送达型事务、TCC 事务）。而且确实之前使用的公司会比较多一些（这个在官网有登记使用的公司，可以看到从 2017 年一直到现在，是有不少公司在用的），目前社区也还一直在开发和维护，还算是比较活跃，个人认为算是一个现在也可以选择的方案。

**mycat**

基于 cobar 改造的，属于 proxy 层方案，支持的功能非常完善，而且目前应该是非常火的而且不断流行的数据库中间件，社区很活跃，也有一些公司开始在用了。但是确实相比于 sharding jdbc 来说，年轻一些，经历的锤炼少一些。

# 数据库如何进行垂直拆分或水平拆分

- 水平拆分： 把一个表的数据拆分到多个库多个表中去，每个库的表结构是一样的，不过每个库中的数据是不同的（抗并发、扩容）

- 垂直拆分： 把以一个有很多字段的表拆分为多个表，或者是多个库上去，每个库表结构都不一样，都只包含部分字段。一般来说，会将访问频率较高的字段放一张表中，访问频率较低的字段放一张表中。因为数据库是有缓存的，你访问频率高的行字段越少，就可以在缓存里缓存更多的行，性能就越好。


